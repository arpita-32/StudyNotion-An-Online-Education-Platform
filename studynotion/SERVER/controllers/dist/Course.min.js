"use strict";var Course=require("../models/Course"),Tag=require("../models/tags"),User=require("../models/User"),_require=require("../utils/imageUploader"),uploadImageToCloudinary=_require.uploadImageToCloudinary;exports.createCourse=function(r,t){var s,a,n,u,o,i,c,l,d,p,g;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=r.body,a=s.courseName,n=s.courseDescription,u=s.whatYouWillLearn,o=s.price,i=s.tag,c=r.files.thumbnailImage,a&&n&&u&&o&&i&&c){e.next=5;break}return e.abrupt("return",t.status(400).json({success:!1,message:"All fields are required"}));case 5:return l=r.user.id,e.next=8,regeneratorRuntime.awrap(User.findById(l));case 8:if(d=e.sent,console.log("Instructor Details:",d),d){e.next=12;break}return e.abrupt("return",t.status(404).json({success:!1,message:"Instructor Details not found"}));case 12:return e.next=14,regeneratorRuntime.awrap(Tag.findById(i));case 14:if(p=e.sent){e.next=17;break}return e.abrupt("return",t.status(400).json({success:!1,message:"Tags Details not found"}));case 17:return e.next=19,regeneratorRuntime.awrap(uploadImageToCloudinary(c,process.env.FOLDER_NAME));case 19:return g=e.sent,e.next=22,regeneratorRuntime.awrap(Course.create({courseName:a,courseDescription:n,instructor:d._id,whatYouWillLearn:u,price:o,tag:p._id,thumbnail:g.secure_url}));case 22:return e.sent,e.next=25,regeneratorRuntime.awrap(User.findByIdAndUpdate);case 25:e.next=29;break;case 27:e.prev=27,e.t0=e.catch(0);case 29:case"end":return e.stop()}},null,null,[[0,27]])};
//# sourceMappingURL=Course.min.js.map

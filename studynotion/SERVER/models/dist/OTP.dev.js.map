{"version":3,"sources":["OTP.js"],"names":["mongoose","require","mailSender","OTPSchema","Schema","email","type","String","required","otp","createdAt","Date","now","expires","sendVerificationEmail","mailResponse","console","log","pre","next","module","exports","model"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMC,UAAU,GAAGD,OAAO,CAAC,qBAAD,CAA1B;;AAEA,IAAME,SAAS,GAAG,IAAIH,QAAQ,CAACI,MAAb,CAAoB;AAClCC,EAAAA,KAAK,EAAE;AACHC,IAAAA,IAAI,EAAEC,MADH;AAEHC,IAAAA,QAAQ,EAAE;AAFP,GAD2B;AAKlCC,EAAAA,GAAG,EAAE;AACDH,IAAAA,IAAI,EAAEC,MADL;AAEDC,IAAAA,QAAQ,EAAE;AAFT,GAL6B;AASlCE,EAAAA,SAAS,EAAE;AACPJ,IAAAA,IAAI,EAAEK,IADC;AAEP,eAASA,IAAI,CAACC,GAFP;AAGPC,IAAAA,OAAO,EAAE,IAAI,EAHN,CAGU;;AAHV;AATuB,CAApB,CAAlB,C,CAgBA;;AACA,SAAeC,qBAAf,CAAqCT,KAArC,EAA4CI,GAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEmCP,UAAU,CACjCG,KADiC,EAEjC,qCAFiC,4FAIEI,GAJF,8DAF7C;;AAAA;AAEcM,UAAAA,YAFd;AAAA,2CASeA,YATf;;AAAA;AAAA;AAAA;AAWQC,UAAAA,OAAO,CAACC,GAAR,CAAY,kDAAZ;AAXR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,C,CAgBA;;;AACAd,SAAS,CAACe,GAAV,CAAc,MAAd,EAAsB,iBAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAERL,qBAAqB,CAAC,KAAKT,KAAN,EAAa,KAAKI,GAAlB,CAFb;;AAAA;AAGdU,UAAAA,IAAI;AAHU;AAAA;;AAAA;AAAA;AAAA;AAKdA,UAAAA,IAAI,cAAJ;;AALc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB;AASAC,MAAM,CAACC,OAAP,GAAiBrB,QAAQ,CAACsB,KAAT,CAAe,KAAf,EAAsBnB,SAAtB,CAAjB","sourcesContent":["const mongoose = require(\"mongoose\");\nconst mailSender = require('../utils/mailSender');\n\nconst OTPSchema = new mongoose.Schema({\n    email: {\n        type: String,\n        required: true,\n    },\n    otp: {\n        type: String,\n        required: true,\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now,\n        expires: 5 * 60, // Document will be automatically deleted after 5 minutes\n    }\n});\n\n// Function to send verification email\nasync function sendVerificationEmail(email, otp) {\n    try {\n        const mailResponse = await mailSender(\n            email,\n            \"Verification Email from StudyNotion\",\n            `<h1>Please verify your email</h1>\n            <p>Your OTP for verification is: ${otp}</p>\n            <p>This OTP is valid for 5 minutes</p>`\n        );\n        return mailResponse;\n    } catch (error) {\n        console.log(\"Error occurred while sending verification email:\", error);\n        throw error;\n    }\n}\n\n// Pre-save middleware to send OTP email\nOTPSchema.pre(\"save\", async function(next) {\n    try {\n        await sendVerificationEmail(this.email, this.otp);\n        next();\n    } catch (error) {\n        next(error);\n    }\n});\n\nmodule.exports = mongoose.model(\"OTP\", OTPSchema);"],"file":"OTP.dev.js"}